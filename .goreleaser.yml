builds:
  - id: bulkai
    binary: bulkai
    main: ./cmd/bulkai
    goarch:
      - amd64
      - arm64
      - arm
  - id: bulkaigui
    binary: bulkaigui
    main: ./cmd/bulkaigui
    goos:
      # Fix building bulkaigui for macos
      # - darwin
      - linux
    goarch:
      - amd64
      # Fix building bulkaigui for arm64
      # - arm64
    ldflags:
      - -s -w -X main.Version={{.Version}} -X main.Commit={{.Commit}} -X main.Date={{.Date}}
  - id: bulkaigui-win
    binary: bulkaigui
    main: ./cmd/bulkaigui
    goos:
      - windows
    goarch:
      - amd64
      - arm64
    ldflags:
      - -s -w -X main.Version={{.Version}} -X main.Commit={{.Commit}} -X main.Date={{.Date}} -H=windowsgui
archives:
  - id: bulkai
    builds:
      - bulkai
    format: zip
    name_template: 'bulkai_{{ .Version }}_{{- if eq .Os "darwin" }}macos{{- else }}{{ .Os }}{{ end }}_{{ .Arch }}'
  - id: bulkaigui
    builds:
      - bulkaigui
      - bulkaigui-win
    format: zip
    name_template: 'bulkaigui_{{ .Version }}_{{- if eq .Os "darwin" }}macos{{- else }}{{ .Os }}{{ end }}_{{ .Arch }}'
signs:
- cmd: cosign
  stdin: '{{ .Env.COSIGN_PWD }}'
  args:
  - "sign-blob"
  - "--key=cosign.key"
  - "--output-signature=${signature}"
  - "${artifact}"
  - "--yes" # needed on cosign 2.0.0+
  artifacts: all
